<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>أنا أتذكّر – صفحة 1</title>

  <style>
    .story-page {
      position: relative;
      max-width: 900px;
      margin: 20px auto;
      border: 1px solid #ddd;
    }

    .page-img {
      width: 100%;
      display: block;
    }

    .text-layer {
      position: absolute;
      inset: 0;
      /* نستخدم direction: ltr هنا لأن الإحداثيات محسوبة من اليسار لتناسب CSS position */
      direction: ltr; 
    }

    .word {
      position: absolute;
      cursor: pointer;
      color: transparent; /* إخفاء النص الحقيقي لإظهار النص الذي في الصورة */
      background: transparent;
      transform: translate(-50%, -50%); /* لضمان دقة التمركز */
      white-space: nowrap;
    }

    /* شكل التظليل */
    .word.active {
      background: rgba(255, 235, 59, 0.5); /* أصفر شفاف */
      box-shadow: 0 0 10px rgba(255, 235, 59, 0.8);
      border-radius: 10px;
      transition: all 0.2s ease;
    }
  </style>
</head>

<body>

  <div class="story-page">
    <img src="./page-01.png" class="page-img" alt="صفحة القصة">
    <div class="text-layer" id="textLayer"></div>
  </div>

  <div style="text-align:center; margin-top:20px;">
    <button onclick="playSequence()" style="padding: 10px 20px; font-size: 16px; cursor: pointer;">▶ تشغيل القراءة</button>
    <button onclick="clearHighlight()" style="padding: 10px 20px; font-size: 16px; cursor: pointer;">إلغاء التظليل</button>
  </div>

  <script>
    // الإحداثيات الدقيقة بناءً على تحليل الصورة
    const wordsData = [
      // السطر الأيمن (من اليمين لليسار)
      { text: "أَتَذَكَّرُ", top: 6.5, left: 85.5, width: 8, height: 6, time: 0 },
      { text: "جَدِّي", top: 6.5, left: 77.5, width: 6, height: 6, time: 800 },
      { text: "وَأَشْتَاقُ", top: 6.5, left: 69.5, width: 9, height: 6, time: 1600 },
      { text: "إِلَيْهِ", top: 6.5, left: 62.5, width: 6, height: 6, time: 2400 },

      // السطر الأيسر (من اليمين لليسار)
      { text: "أَتَذَكَّرُ", top: 6.5, left: 42.5, width: 8, height: 6, time: 3400 },
      { text: "وَجْهَهُ", top: 6.5, left: 34.5, width: 7, height: 6, time: 4200 },
      { text: "وَضِحْكَتَهُ", top: 6.5, left: 25.5, width: 9, height: 6, time: 5000 },
      { text: "وَشَارِبَيْهِ", top: 6.5, left: 15.5, width: 10, height: 6, time: 5800 }
    ];

    const layer = document.getElementById("textLayer");
    let wordEls = [];

    // إنشاء عناصر التظليل
    wordsData.forEach(w => {
      const span = document.createElement("span");
      span.textContent = w.text;
      span.className = "word";
      
      // ضبط الموقع والأبعاد بالنسب المئوية لضمان التجاوب (Responsive)
      span.style.top = w.top + "%";
      span.style.left = w.left + "%";
      span.style.width = w.width + "%";
      span.style.height = w.height + "%";

      span.dataset.time = w.time;

      span.onclick = () => {
        clearHighlight();
        span.classList.add("active");
      };

      layer.appendChild(span);
      wordEls.push(span);
    });

    function clearHighlight() {
      wordEls.forEach(w => w.classList.remove("active"));
    }

    let timeouts = [];

    function playSequence() {
      // إلغاء أي عمليات قراءة جارية حالياً
      timeouts.forEach(t => clearTimeout(t));
      timeouts = [];
      clearHighlight();

      wordEls.forEach(word => {
        const t = parseInt(word.dataset.time, 10);
        const timeout = setTimeout(() => {
          clearHighlight();
          word.classList.add("active");
        }, t);
        timeouts.push(timeout);
      });
    }
  </script>

</body>
</html>
